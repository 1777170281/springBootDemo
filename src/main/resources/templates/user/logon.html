<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>用户注册</title>
</head>
<body>
<link rel="stylesheet" href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}">
<link rel="stylesheet" href="../static/css/bootstrapValidator.min.css" th:href="@{/css/bootstrapValidator.min.css}">
<link rel="stylesheet" href="../static/css/bootstrap-datetimepicker.css" th:href="@{/css/bootstrap-datetimepicker.css}">


<!-- Font Awesome -->
<link rel="stylesheet" href="../static/css/font-awesome.css" th:href="@{/css/font-awesome.css}">
<!-- Ionicons -->
<link rel="stylesheet" href="../static/css/ionicons.css" th:href="@{/css/ionicons.css}">
<!-- Theme style -->
<link rel="stylesheet" href="../static/css/AdminLTE.css" th:href="@{/css/AdminLTE.css}">
<!-- AdminLTE Skins. We have chosen the skin-blue for this starter
      page. However, you can choose any other skin. Make sure you
      apply the skin class to the body tag so the changes take effect. -->
<link rel="stylesheet" href="../static/css/skins/skin-blue.min.css" th:href="@{/css/skins/skin-blue.min.css}">

<link href="../static/css/bootstrap-table.css" th:href="@{/css/bootstrap-table.css}" rel="stylesheet">
<link href="../static/css/jquery.treegrid.css" th:href="@{/css/jquery.treegrid.css}" rel="stylesheet">
<link href="../static/css/bootstrap-tab.css" th:href="@{/css/bootstrap-tab.css}" rel="stylesheet">
<link href="../static/css/myCommon.css" th:href="@{/css/myCommon.css}" rel="stylesheet">


<script src="../static/js/jquery-3.3.1.min.js" th:src="@{/js/jquery-3.3.1.min.js}"></script>
<script src="../static/js/jquery.form.js" th:src="@{/js/jquery.form.js}"></script>
<script src="../static/js/bootstrap.min.js" th:src="@{/js/bootstrap.min.js}"></script>
<script src="../static/js/adminlte.js" th:src="@{/js/adminlte.js}"></script>

<script src="../static/js/bootstrapValidator.min.js" th:src="@{/js/bootstrapValidator.min.js}"></script>
<script src="../static/js/bootstrap-datetimepicker.js" th:src="@{/js/bootstrap-datetimepicker.js}"></script>
<script src="../static/js/bootstrap-datetimepicker.zh-TW.js" th:src="@{/js/bootstrap-datetimepicker.zh-TW.js}"></script>

<script src="../static/js/bootstrap-table.js" th:src="@{/js/bootstrap-table.js}"></script>
<script src="../static/js/bootstrap-table-zh-CN.js" th:src="@{/js/bootstrap-table-zh-CN.js}"></script>
<script src="../static/js/bootstrap-table-treegrid.js" th:src="@{/js/bootstrap-table-treegrid.js}"></script>
<script src="../static/js/jquery.treegrid.min.js" th:src="@{/js/jquery.treegrid.min.js}"></script>

<script src="../static/js/bootstrap-tab.js" th:src="@{/js/bootstrap-tab.js}"></script>

<script src="../static/js/bootstrap-table-export.js" th:src="@{/js/bootstrap-table-export.js}"></script>
<script src="../static/js/tableExport.min.js" th:src="@{/js/tableExport.min.js}"></script>
<script src="../static/js/FileSaver.min.js" th:src="@{/js/FileSaver.min.js}"></script>
<script src="../static/js/xlsx.core.min.js" th:src="@{/js/xlsx.core.min.js}"></script>


<div class="container-fluid panel-body" style="padding-bottom:0px">
    <form class="form-horizontal validation-form" id="formAdd" action="#" th:action="@{/user/logon}" method="post">
        <div class="panel panel-default" style="margin-bottom: 0px">
            <h4 class="panel panel-heading h4font" >
                用户注册<small>（＊星号是必填项）</small>
            </h4>

            <div class="panel-body">
                <div class="form-group">
                    <label class="col-sm-1 control-label"><span style="color: red;font-weight: bold">＊</span>用户名</label>
                    <div class="col-sm-4">
                        <input type="text" class="form-control" name="userName" placeholder="用户名">
                    </div>
                    <label class="control-label">（输入类型是
                        字母、数字、下划线或它们的组合，最少3位，最长16位）</label>
                </div>

                <div class="form-group">
                    <label class="col-sm-1 control-label"><span style="color: red;font-weight: bold">＊</span>姓名</label>
                    <div class="col-sm-4">
                        <input type="text" class="form-control" name="name" placeholder="姓名">
                    </div>
                    <label class="control-label">（输入类型是汉字、字母、数字、下划线或它们的组合，最少3位，最长16位）</label>
                </div>

                <div class="form-group">
                    <label class="col-sm-1 control-label"><span style="color: red;font-weight: bold">＊</span>密码</label>
                    <div class="col-sm-4">
                        <input type="password" class="form-control" name="password" placeholder="密码">
                    </div>
                    <label class="control-label">（密码长度至少6位）</label>
                </div>
                <div class="form-group">
                    <label class="col-sm-1 control-label"><span style="color: red;font-weight: bold">＊</span>邮箱</label>
                    <div class="col-sm-4">
                        <input type="text" class="form-control" name="email" placeholder="电子邮箱">
                    </div>
                    <label class="control-label">（格式：xxx@xxx.com）</label>
                    <a id="comfirmEmail" style="cursor: pointer">点 击 验 证</a>
                </div>
                <div class="form-group">
                    <label class="col-sm-1 control-label"><span style="color: red;font-weight: bold">＊</span>邮箱验证</label>
                    <div class="col-sm-4">
                        <input type="text" class="form-control" name="emailCode" placeholder="输入邮箱验证码">
                    </div>
                </div>
            </div>
        </div>

        <br/>

        <div class="form-group">
            <div class="col-sm-offset-5 col-sm-1">
                <button type="submit" class="btn btn-primary">保 存</button>
            </div>

            <div class="col-sm-1">
                <button name="backToList" type="button" class="btn btn-primary">返 回</button>
            </div>
        </div>


    </form>

</div>




<script th:inline="javascript">
    var emailReg=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;
    $("#comfirmEmail").on('click',function () {
        var email=$('input[name="email"]').val().trim();
        if(email!=''){
            if(emailReg.test(email)){
                $.ajax({
                    //请求方式
                    type : "POST",
                    //请求的媒体类型
                    contentType: "application/json;charset=UTF-8",
                    //请求地址
                    url : "/user/confirmEmail",
                    //数据，json字符串
                    data : JSON.stringify({'email':email}),
                    //请求成功
                    success : function(result) {
                        if(result.code=='000000'){
                            //重定向到登录页面

                            window.location.href="/user/login?userName="+$('input[name="userName"]').val().trim();
                        }else{
                            alert(result.desc);
                        }
                    },
                    //请求失败，包含具体的错误信息
                    error : function(e){
                        console.log(e.status);
                        console.log(e.responseText);
                    }
                })

            }else{
                alert("请输入正确的邮箱格式!");
            }
        }else{
            alert('请输入邮箱后再验证!');
        }
    })

    $(function () {

    })
</script>

</body>
</html>